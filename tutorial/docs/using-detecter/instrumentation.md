--8<-- "includes/common.md"

# Instrumentation
---

Types of instrumentation detecter supports.


## Targeting processes

detectEr provides the keywords `#!shml with` and `#!shml monitor` to target program processes for a particular sHML specification.
The `#!shml with` keyword picks out the signature of the function that is spawned as a process, whereas the `#!shml monitor` keyword defines the property to be runtime analysed.
For example, to verify the behaviour of our calculator process against the [formula above](#__code_1), we write:

```shml
with
  calc_server:loop(_)
monitor
  and([Srv:Clt ! {bye,Tot} when Tot < 0])ff
```

From an [instrumentation](instrumentation.md) standpoint, `#!shml with` establishes the set of trace event corresponding to the program process it targets, thus enabling the specification to *abstract* from the events that are generated by other processes.
This helps maintain the size of sHML specifications compact whenever possible.
In using `#!shml with`, our formula need not account for superfluous trace events (*e.g.* of another calculator process) that tend to make the specification exercise tedious and error-prone.



* Diagram of the system architecture.

* How the same generated analyzer code is used to instrument the Erlang, Elixir and Python setups. 



# Generating the monitor 

This is a common aspect to all types of instrumentation. Treating it centrally reinforces this fact.

## Outline instrumentation

Might be in its own section.